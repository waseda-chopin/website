<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Introduction</title>
    <meta name="description" content="概要">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/component.css">
</head>
<body>
    <div id="header"></div>

    <div class="introfield">
        <ul class="tree" id="intro-tree">
            <h2>Introduction</h2>
            </ul>
        
        <div class="introcontents" id="intro-contents">
            </div>
    </div>

    <div id="footer"></div>

    <script>
        // ヘッダーの読み込み
        fetch("pc-header.html")
            .then((response) => response.text())
            .then((data) => document.querySelector("#header").innerHTML = data)
            .catch((error) => console.error("pc-header.html の読み込みに失敗しました:", error));

        // フッターの読み込み
        fetch("footer.html")
            .then((response) => response.text())
            .then((data) => {
                const footer = document.querySelector("#footer");
                if (footer) {
                    footer.innerHTML = data;
                } else {
                    console.error("要素 #footer が見つかりません。");
                }
            })
            .catch((error) => console.error("footer.html の読み込みに失敗しました:", error));

        // Introductionデータの読み込みと反映
        fetch("data/introduction.json")
            .then(response => response.json())
            .then(data => {
                const treeContainer = document.getElementById("intro-tree");
                const contentsContainer = document.getElementById("intro-contents");

                data.forEach((item, index) => {
                    // --- 1. 左側の目次 (<li>) を生成 ---
                    const li = document.createElement("li");
                    const a = document.createElement("a");
                    a.textContent = item.title;
                    // クリック時に該当セクションへスクロールさせるためのリンク
                    a.href = `#section-${index}`;
                    // 元のCSSにリンクの色設定がない場合を考慮し、スタイルを少し調整
                    a.style.textDecoration = "none";
                    a.style.color = "inherit";
                    li.appendChild(a);
                    treeContainer.appendChild(li);

                    // --- 2. 右側のコンテンツを生成 ---
                    const sectionDiv = document.createElement("div");
                    // スムーズスクロール用のIDを付与
                    sectionDiv.id = `section-${index}`; 

                    // 見出し部分の生成 (<div class="index">...</div>)
                    const indexDiv = document.createElement("div");
                    indexDiv.className = "index";
                    indexDiv.innerHTML = `<hr><div class="introindex">${item.title}</div><hr>`;
                    sectionDiv.appendChild(indexDiv);

                    // 本文の生成 (改行ごとに <p> タグで囲む)
                    if (item.content) {
                        const paragraphs = item.content.split('\n');
                        paragraphs.forEach(text => {
                            if (text.trim() !== "") {
                                const p = document.createElement("p");
                                p.textContent = text;
                                sectionDiv.appendChild(p);
                            }
                        });
                    }

                    // リンクが存在する場合の生成
                    if (item.link) {
                        const linkP = document.createElement("p");
                        const linkA = document.createElement("a");
                        linkA.href = item.link;
                        linkA.textContent = "詳細はこちら";
                        linkA.target = "_blank"; // 別タブで開く
                        linkP.appendChild(linkA);
                        sectionDiv.appendChild(linkP);
                    }

                    // コンテンツエリアに追加
                    contentsContainer.appendChild(sectionDiv);
                });
            })
            .catch(error => console.error("introduction.json の読み込みに失敗しました:", error));
    </script>
</body>
</html>